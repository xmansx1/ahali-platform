{% extends "core/base.html" %}
{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto bg-white rounded-xl shadow p-6">
  <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">ğŸ‘¤ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h2>

  <ul class="space-y-3 text-sm text-gray-700">
    <li><strong>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:</strong> {{ user.username }}</li>
    <li><strong>ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„:</strong> {{ user.phone_number|default:"-" }}</li>
    <li><strong>ğŸ§¾ Ø§Ù„Ù†ÙˆØ¹:</strong> {{ user.get_user_type_display }}</li>
    <li><strong>âš™ï¸ Ø§Ù„Ø­Ø§Ù„Ø©:</strong>
      {% if user.is_active %}
        <span class="text-green-600 font-semibold">Ù…ÙØ¹Ù„</span>
      {% else %}
        <span class="text-red-600 font-semibold">Ù…Ø¹Ø·Ù„</span>
      {% endif %}
    </li>

    {% if user.user_type == "merchant" and user.store %}
      <li><strong>ğŸ“ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ØªØ¬Ø±:</strong> {{ user.store.address|default:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯" }}</li>
      <li><strong>ğŸ“Œ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª:</strong>
        {% if user.store.latitude and user.store.longitude %}
          {{ user.store.latitude }}, {{ user.store.longitude }}
        {% else %}
          <span class="text-red-500">ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©</span>
        {% endif %}
      </li>
    {% endif %}
  </ul>

  {% if user.user_type == "merchant" and user.store and user.store.latitude and user.store.longitude %}
    <div class="mt-6">
      <label class="block mb-2 text-sm font-semibold text-gray-700">ğŸ—ºï¸ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¬Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</label>
      <div id="map" class="h-64 rounded border shadow"></div>
    </div>
  {% endif %}

  <div class="mt-8 flex flex-wrap gap-3">
    <a href="{% url 'admin_users' %}" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded">ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹</a>

    <a href="{% url 'admin_change_password' user.id %}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">âœï¸ ØªØ¹Ø¯ÙŠÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</a>

    <a href="{% url 'admin_edit_user' user.id %}" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">ğŸ› ï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</a>

    {% if user.user_type == 'merchant' %}
      <a href="{% url 'admin_store_edit' user.store.id %}" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded">ğŸª ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±</a>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
  {% if user.user_type == "merchant" and user.store and user.store.latitude and user.store.longitude %}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const lat = {{ user.store.latitude }};
      const lng = {{ user.store.longitude }};
      const map = L.map("map").setView([lat, lng], 14);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);
      L.marker([lat, lng]).addTo(map).bindPopup("ğŸ“ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¬Ø±").openPopup();
    });
  </script>
  {% endif %}
{% endblock %}
